<!-- HTML header for doxygen 1.12.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LibJWT: Validation Functions</title>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<script src="https://kit.fontawesome.com/c7bbc33ac5.js" crossorigin="anonymous"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="libjwt.css" rel="stylesheet" type="text/css"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
	DoxygenAwesomeFragmentCopyButton.init()
</script>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript">
	DoxygenAwesomeParagraphLink.init()
</script>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
	DoxygenAwesomeInteractiveToc.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="LibJWT-Icon-95x91.png"/></td>
  <td id="projectalign">
   <div id="projectname">LibJWT<span id="projectnumber">&#160;v2.1.0</span>
   </div>
   <div id="projectbrief">The C JSON Web Token Library +JWK +JWKS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__jwt__valid__grp.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Validation Functions<div class="ingroups"><a class="el" href="group__jwt__grp.html">JSON Web Token</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>These functions allow you to define requirements for JWT validation.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Validation Functions:</div>
<div class="dyncontent">
<div class="center"><img src="group__jwt__valid__grp.png" border="0" usemap="#agroup____jwt____valid____grp" alt=""/></div>
<map name="agroup____jwt____valid____grp" id="agroup____jwt____valid____grp">
<area shape="rect" href="group__jwt__grp.html" title=" " alt="" coords="5,5,132,31"/>
<area shape="rect" title="These functions allow you to define requirements for JWT validation." alt="" coords="180,5,318,31"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gac413377fbfc11671e8a8a66f45693e5d" id="r_gac413377fbfc11671e8a8a66f45693e5d"><td class="memItemLeft" align="right" valign="top">typedef struct jwt_valid&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a></td></tr>
<tr class="memdesc:gac413377fbfc11671e8a8a66f45693e5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opaque JWT Validation object.  <br /></td></tr>
<tr class="separator:gac413377fbfc11671e8a8a66f45693e5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga47ee94f9c08ff581f78590bfe024f6e4" id="r_ga47ee94f9c08ff581f78590bfe024f6e4"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga47ee94f9c08ff581f78590bfe024f6e4">jwt_valid_exception_t</a> { <br />
&#160;&#160;<a class="el" href="#gga47ee94f9c08ff581f78590bfe024f6e4a94bb9121f597e706e89322b0f9a7330b">JWT_VALIDATION_SUCCESS</a>
, <a class="el" href="#gga47ee94f9c08ff581f78590bfe024f6e4ad2e58b1f8a8bc39518b1c973fa99ee6e">JWT_VALIDATION_ERROR</a>
, <a class="el" href="#gga47ee94f9c08ff581f78590bfe024f6e4abf0dc5dd94b521a118485a9522cd8cea">JWT_VALIDATION_ALG_MISMATCH</a>
, <a class="el" href="#gga47ee94f9c08ff581f78590bfe024f6e4a698be61a7f4bcf0dfd9894e1c6296e0b">JWT_VALIDATION_EXPIRED</a>
, <br />
&#160;&#160;<a class="el" href="#gga47ee94f9c08ff581f78590bfe024f6e4a685c5270c214bf2484b65376e4b7459b">JWT_VALIDATION_TOO_NEW</a>
, <a class="el" href="#gga47ee94f9c08ff581f78590bfe024f6e4a0dde2793247cd11fbf017212d8fd605f">JWT_VALIDATION_ISS_MISMATCH</a>
, <a class="el" href="#gga47ee94f9c08ff581f78590bfe024f6e4ac8b2989c55deb3bdad631c61f1ed304d">JWT_VALIDATION_SUB_MISMATCH</a>
, <a class="el" href="#gga47ee94f9c08ff581f78590bfe024f6e4acb9d53e3cc20a39c0827d77a071271e6">JWT_VALIDATION_AUD_MISMATCH</a>
, <br />
&#160;&#160;<a class="el" href="#gga47ee94f9c08ff581f78590bfe024f6e4a94eb7551ec626004a55798ecbd563d38">JWT_VALIDATION_GRANT_MISSING</a>
, <a class="el" href="#gga47ee94f9c08ff581f78590bfe024f6e4a5b1db073c57082b557592b7115a8e363">JWT_VALIDATION_GRANT_MISMATCH</a>
<br />
 }</td></tr>
<tr class="memdesc:ga47ee94f9c08ff581f78590bfe024f6e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validation exception types for <a class="el" href="group__jwt__core__grp.html#gabf0acfb990d245214216af589c1d0947">jwt_t</a> objects.  <a href="#ga47ee94f9c08ff581f78590bfe024f6e4">More...</a><br /></td></tr>
<tr class="separator:ga47ee94f9c08ff581f78590bfe024f6e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9ce197165c625f967f889212ca9fab86" id="r_ga9ce197165c625f967f889212ca9fab86"><td class="memItemLeft" align="right" valign="top">JWT_EX <a class="el" href="#ga47ee94f9c08ff581f78590bfe024f6e4">jwt_valid_exception_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9ce197165c625f967f889212ca9fab86">jwt_validate</a> (<a class="el" href="group__jwt__core__grp.html#gabf0acfb990d245214216af589c1d0947">jwt_t</a> *jwt, <a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid)</td></tr>
<tr class="memdesc:ga9ce197165c625f967f889212ca9fab86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate a JWT object with a validation object.  <br /></td></tr>
<tr class="separator:ga9ce197165c625f967f889212ca9fab86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga88d954bf262717532dba3f8d9d29c8af" id="r_ga88d954bf262717532dba3f8d9d29c8af"><td class="memItemLeft" align="right" valign="top">JWT_EX int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga88d954bf262717532dba3f8d9d29c8af">jwt_valid_new</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> **jwt_valid, <a class="el" href="group__jwt__core__grp.html#ga889db178d8714ab67bc994f1d8faad33">jwt_alg_t</a> alg)</td></tr>
<tr class="memdesc:ga88d954bf262717532dba3f8d9d29c8af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new, JWT validation object.  <br /></td></tr>
<tr class="separator:ga88d954bf262717532dba3f8d9d29c8af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga728df4b06a8265eaaea237641185c76f" id="r_ga728df4b06a8265eaaea237641185c76f"><td class="memItemLeft" align="right" valign="top">JWT_EX void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga728df4b06a8265eaaea237641185c76f">jwt_valid_free</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid)</td></tr>
<tr class="memdesc:ga728df4b06a8265eaaea237641185c76f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a JWT validation object and any other resources it is using.  <br /></td></tr>
<tr class="separator:ga728df4b06a8265eaaea237641185c76f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaffc50a84a9914aa74f233054fd243a61" id="r_gaffc50a84a9914aa74f233054fd243a61"><td class="memItemLeft" align="right" valign="top">JWT_EX <a class="el" href="#ga47ee94f9c08ff581f78590bfe024f6e4">jwt_valid_exception_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaffc50a84a9914aa74f233054fd243a61">jwt_valid_get_status</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid)</td></tr>
<tr class="memdesc:gaffc50a84a9914aa74f233054fd243a61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the status string for the validation object.  <br /></td></tr>
<tr class="separator:gaffc50a84a9914aa74f233054fd243a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaea88716bb3596c459da61677e8184662" id="r_gaea88716bb3596c459da61677e8184662"><td class="memItemLeft" align="right" valign="top">JWT_EX time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaea88716bb3596c459da61677e8184662">jwt_valid_get_nbf_leeway</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid)</td></tr>
<tr class="memdesc:gaea88716bb3596c459da61677e8184662"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the nbf_leeway value set.  <br /></td></tr>
<tr class="separator:gaea88716bb3596c459da61677e8184662"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeb53cb3059ef0a6969f9d401e76958c2" id="r_gaeb53cb3059ef0a6969f9d401e76958c2"><td class="memItemLeft" align="right" valign="top">JWT_EX time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaeb53cb3059ef0a6969f9d401e76958c2">jwt_valid_get_exp_leeway</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid)</td></tr>
<tr class="memdesc:gaeb53cb3059ef0a6969f9d401e76958c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the exp_leeway value set.  <br /></td></tr>
<tr class="separator:gaeb53cb3059ef0a6969f9d401e76958c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf314c644fea06547647958483759ceac" id="r_gaf314c644fea06547647958483759ceac"><td class="memItemLeft" align="right" valign="top">JWT_EX int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf314c644fea06547647958483759ceac">jwt_valid_add_grant</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const char *grant, const char *val)</td></tr>
<tr class="memdesc:gaf314c644fea06547647958483759ceac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new string grant requirement to this JWT validation object.  <br /></td></tr>
<tr class="separator:gaf314c644fea06547647958483759ceac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f2277d29179a01928c0ebe4fbef1a7c" id="r_ga7f2277d29179a01928c0ebe4fbef1a7c"><td class="memItemLeft" align="right" valign="top">JWT_EX const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7f2277d29179a01928c0ebe4fbef1a7c">jwt_valid_get_grant</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const char *grant)</td></tr>
<tr class="memdesc:ga7f2277d29179a01928c0ebe4fbef1a7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the value of a string required grant.  <br /></td></tr>
<tr class="separator:ga7f2277d29179a01928c0ebe4fbef1a7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabacde09b87fca8b096d291163f4c4a5c" id="r_gabacde09b87fca8b096d291163f4c4a5c"><td class="memItemLeft" align="right" valign="top">JWT_EX int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gabacde09b87fca8b096d291163f4c4a5c">jwt_valid_add_grant_int</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const char *grant, long val)</td></tr>
<tr class="memdesc:gabacde09b87fca8b096d291163f4c4a5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new integer grant requirement to this JWT validation object.  <br /></td></tr>
<tr class="separator:gabacde09b87fca8b096d291163f4c4a5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1af73c88e51e80f456e10cdd43bcf2f1" id="r_ga1af73c88e51e80f456e10cdd43bcf2f1"><td class="memItemLeft" align="right" valign="top">JWT_EX long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1af73c88e51e80f456e10cdd43bcf2f1">jwt_valid_get_grant_int</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const char *grant)</td></tr>
<tr class="memdesc:ga1af73c88e51e80f456e10cdd43bcf2f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the value of an integer required grant.  <br /></td></tr>
<tr class="separator:ga1af73c88e51e80f456e10cdd43bcf2f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8900a467e4176b1fa9b622a2705269ee" id="r_ga8900a467e4176b1fa9b622a2705269ee"><td class="memItemLeft" align="right" valign="top">JWT_EX int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8900a467e4176b1fa9b622a2705269ee">jwt_valid_add_grant_bool</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const char *grant, int val)</td></tr>
<tr class="memdesc:ga8900a467e4176b1fa9b622a2705269ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new boolean required grant to this JWT validation object.  <br /></td></tr>
<tr class="separator:ga8900a467e4176b1fa9b622a2705269ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1bcf672c544bd4d2ebb656a79ce90f69" id="r_ga1bcf672c544bd4d2ebb656a79ce90f69"><td class="memItemLeft" align="right" valign="top">JWT_EX int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1bcf672c544bd4d2ebb656a79ce90f69">jwt_valid_get_grant_bool</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const char *grant)</td></tr>
<tr class="memdesc:ga1bcf672c544bd4d2ebb656a79ce90f69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the value of an boolean required grant.  <br /></td></tr>
<tr class="separator:ga1bcf672c544bd4d2ebb656a79ce90f69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab75b56ce400f582ace10a4e524635286" id="r_gab75b56ce400f582ace10a4e524635286"><td class="memItemLeft" align="right" valign="top">JWT_EX int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab75b56ce400f582ace10a4e524635286">jwt_valid_add_grants_json</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const char *json)</td></tr>
<tr class="memdesc:gab75b56ce400f582ace10a4e524635286"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add required grants from a JSON encoded object string.  <br /></td></tr>
<tr class="separator:gab75b56ce400f582ace10a4e524635286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19a0badfa97417865fe6053c8d9c076e" id="r_ga19a0badfa97417865fe6053c8d9c076e"><td class="memItemLeft" align="right" valign="top">JWT_EX char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga19a0badfa97417865fe6053c8d9c076e">jwt_valid_get_grants_json</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const char *grant)</td></tr>
<tr class="memdesc:ga19a0badfa97417865fe6053c8d9c076e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the value of a grant as JSON encoded object string.  <br /></td></tr>
<tr class="separator:ga19a0badfa97417865fe6053c8d9c076e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf9f8b1dbe950cf2fc9a8200cf749a442" id="r_gaf9f8b1dbe950cf2fc9a8200cf749a442"><td class="memItemLeft" align="right" valign="top">JWT_EX int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf9f8b1dbe950cf2fc9a8200cf749a442">jwt_valid_del_grants</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const char *grant)</td></tr>
<tr class="memdesc:gaf9f8b1dbe950cf2fc9a8200cf749a442"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a grant from this JWT object.  <br /></td></tr>
<tr class="separator:gaf9f8b1dbe950cf2fc9a8200cf749a442"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8e5fbc676ebc0a0286bc70b9d062d53e" id="r_ga8e5fbc676ebc0a0286bc70b9d062d53e"><td class="memItemLeft" align="right" valign="top">JWT_EX int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8e5fbc676ebc0a0286bc70b9d062d53e">jwt_valid_set_now</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const time_t now)</td></tr>
<tr class="memdesc:ga8e5fbc676ebc0a0286bc70b9d062d53e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the time for which expires and not-before claims should be evaluated.  <br /></td></tr>
<tr class="separator:ga8e5fbc676ebc0a0286bc70b9d062d53e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae0319eaec4c9a1e706b85aa365ada20e" id="r_gae0319eaec4c9a1e706b85aa365ada20e"><td class="memItemLeft" align="right" valign="top">JWT_EX int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae0319eaec4c9a1e706b85aa365ada20e">jwt_valid_set_nbf_leeway</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const time_t nbf_leeway)</td></tr>
<tr class="memdesc:gae0319eaec4c9a1e706b85aa365ada20e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the nbf_leeway value as defined in: <a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.5">https://www.rfc-editor.org/rfc/rfc7519#section-4.1.5</a>.  <br /></td></tr>
<tr class="separator:gae0319eaec4c9a1e706b85aa365ada20e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7d4a3188a889ae2a0837aec6f358cde5" id="r_ga7d4a3188a889ae2a0837aec6f358cde5"><td class="memItemLeft" align="right" valign="top">JWT_EX int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7d4a3188a889ae2a0837aec6f358cde5">jwt_valid_set_exp_leeway</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, const time_t exp_leeway)</td></tr>
<tr class="memdesc:ga7d4a3188a889ae2a0837aec6f358cde5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the exp_leeway value as defined in: <a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.4">https://www.rfc-editor.org/rfc/rfc7519#section-4.1.4</a>.  <br /></td></tr>
<tr class="separator:ga7d4a3188a889ae2a0837aec6f358cde5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf12cd57921f54714ec74ced386a80981" id="r_gaf12cd57921f54714ec74ced386a80981"><td class="memItemLeft" align="right" valign="top">JWT_EX int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf12cd57921f54714ec74ced386a80981">jwt_valid_set_headers</a> (<a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *jwt_valid, int hdr)</td></tr>
<tr class="memdesc:gaf12cd57921f54714ec74ced386a80981"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set validation for replicated claims in headers.  <br /></td></tr>
<tr class="separator:gaf12cd57921f54714ec74ced386a80981"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga62aa101df260ec31133eeb4c4c52b80a" id="r_ga62aa101df260ec31133eeb4c4c52b80a"><td class="memItemLeft" align="right" valign="top">JWT_EX char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga62aa101df260ec31133eeb4c4c52b80a">jwt_exception_str</a> (unsigned int exceptions)</td></tr>
<tr class="memdesc:ga62aa101df260ec31133eeb4c4c52b80a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses exceptions and returns a comma delimited and human-readable string.  <br /></td></tr>
<tr class="separator:ga62aa101df260ec31133eeb4c4c52b80a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>These functions allow you to define requirements for JWT validation. </p>
<p>The most basic validation is that the JWT uses the expected algorithm.</p>
<p>When replicating claims in header (usually for encrypted JWT), validation tests that they match claims in the body (iss, sub, aud).</p>
<p>Time-based claims can also be validated (nbf, exp).</p>
<p>Finally, validation can test that claims be present and have certain value. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gac413377fbfc11671e8a8a66f45693e5d" name="gac413377fbfc11671e8a8a66f45693e5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac413377fbfc11671e8a8a66f45693e5d">&#9670;&#160;</a></span>jwt_valid_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct jwt_valid <a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opaque JWT Validation object. </p>
<p>Used in the JWT validation functions. </p>

<p class="definition">Definition at line <a class="el" href="jwt_8h_source.html#l00075">75</a> of file <a class="el" href="jwt_8h_source.html">jwt.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga47ee94f9c08ff581f78590bfe024f6e4" name="ga47ee94f9c08ff581f78590bfe024f6e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47ee94f9c08ff581f78590bfe024f6e4">&#9670;&#160;</a></span>jwt_valid_exception_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ga47ee94f9c08ff581f78590bfe024f6e4">jwt_valid_exception_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validation exception types for <a class="el" href="group__jwt__core__grp.html#gabf0acfb990d245214216af589c1d0947">jwt_t</a> objects. </p>
<p>These are bitwise values that allow you to check for exceptions when using the <a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a></p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo</a></b></dt><dd><p class="startdd"><a href="https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.6" target="_blank"><em class="fa-regular fa-file-lines"></em> RFC-7519 Sec 4.1.6</a> <code>"iat"</code> Issued At </p>
<p class="enddd"><a href="https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.7" target="_blank"><em class="fa-regular fa-file-lines"></em> RFC-7519 Sec 4.1.7</a> <code>"jti"</code> JWT ID </p>
</dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga47ee94f9c08ff581f78590bfe024f6e4a94bb9121f597e706e89322b0f9a7330b" name="gga47ee94f9c08ff581f78590bfe024f6e4a94bb9121f597e706e89322b0f9a7330b"></a>JWT_VALIDATION_SUCCESS&#160;</td><td class="fielddoc"><p>Validation succeeded <br  />
 </p>
</td></tr>
<tr><td class="fieldname"><a id="gga47ee94f9c08ff581f78590bfe024f6e4ad2e58b1f8a8bc39518b1c973fa99ee6e" name="gga47ee94f9c08ff581f78590bfe024f6e4ad2e58b1f8a8bc39518b1c973fa99ee6e"></a>JWT_VALIDATION_ERROR&#160;</td><td class="fielddoc"><p>General failures <br  />
 </p>
</td></tr>
<tr><td class="fieldname"><a id="gga47ee94f9c08ff581f78590bfe024f6e4abf0dc5dd94b521a118485a9522cd8cea" name="gga47ee94f9c08ff581f78590bfe024f6e4abf0dc5dd94b521a118485a9522cd8cea"></a>JWT_VALIDATION_ALG_MISMATCH&#160;</td><td class="fielddoc"><p><a href="https://datatracker.ietf.org/doc/html/rfc7518#section-3.1" target="_blank"><em class="fa-regular fa-file-lines"></em> RFC-7518 Sec 3.1</a> <code>"alg"</code> Algorithm <br  />
 </p>
</td></tr>
<tr><td class="fieldname"><a id="gga47ee94f9c08ff581f78590bfe024f6e4a698be61a7f4bcf0dfd9894e1c6296e0b" name="gga47ee94f9c08ff581f78590bfe024f6e4a698be61a7f4bcf0dfd9894e1c6296e0b"></a>JWT_VALIDATION_EXPIRED&#160;</td><td class="fielddoc"><p><a href="https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.4" target="_blank"><em class="fa-regular fa-file-lines"></em> RFC-7519 Sec 4.1.4</a> <code>"exp"</code> Expired </p>
</td></tr>
<tr><td class="fieldname"><a id="gga47ee94f9c08ff581f78590bfe024f6e4a685c5270c214bf2484b65376e4b7459b" name="gga47ee94f9c08ff581f78590bfe024f6e4a685c5270c214bf2484b65376e4b7459b"></a>JWT_VALIDATION_TOO_NEW&#160;</td><td class="fielddoc"><p><a href="https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.5" target="_blank"><em class="fa-regular fa-file-lines"></em> RFC-7519 Sec 4.1.5</a> <code>"nbf"</code> Not Before <br  />
 </p>
</td></tr>
<tr><td class="fieldname"><a id="gga47ee94f9c08ff581f78590bfe024f6e4a0dde2793247cd11fbf017212d8fd605f" name="gga47ee94f9c08ff581f78590bfe024f6e4a0dde2793247cd11fbf017212d8fd605f"></a>JWT_VALIDATION_ISS_MISMATCH&#160;</td><td class="fielddoc"><p><a href="https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.1" target="_blank"><em class="fa-regular fa-file-lines"></em> RFC-7519 Sec 4.1.1</a> <code>"iss"</code> Issuer <br  />
 </p>
</td></tr>
<tr><td class="fieldname"><a id="gga47ee94f9c08ff581f78590bfe024f6e4ac8b2989c55deb3bdad631c61f1ed304d" name="gga47ee94f9c08ff581f78590bfe024f6e4ac8b2989c55deb3bdad631c61f1ed304d"></a>JWT_VALIDATION_SUB_MISMATCH&#160;</td><td class="fielddoc"><p><a href="https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.2" target="_blank"><em class="fa-regular fa-file-lines"></em> RFC-7519 Sec 4.1.2</a> <code>"sub"</code> Subject </p>
</td></tr>
<tr><td class="fieldname"><a id="gga47ee94f9c08ff581f78590bfe024f6e4acb9d53e3cc20a39c0827d77a071271e6" name="gga47ee94f9c08ff581f78590bfe024f6e4acb9d53e3cc20a39c0827d77a071271e6"></a>JWT_VALIDATION_AUD_MISMATCH&#160;</td><td class="fielddoc"><p><a href="https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.3" target="_blank"><em class="fa-regular fa-file-lines"></em> RFC-7519 Sec 4.1.3</a> <code>"aud"</code> Audience <br  />
 </p>
</td></tr>
<tr><td class="fieldname"><a id="gga47ee94f9c08ff581f78590bfe024f6e4a94eb7551ec626004a55798ecbd563d38" name="gga47ee94f9c08ff581f78590bfe024f6e4a94eb7551ec626004a55798ecbd563d38"></a>JWT_VALIDATION_GRANT_MISSING&#160;</td><td class="fielddoc"><p>User-defined Grant missing <br  />
 </p>
</td></tr>
<tr><td class="fieldname"><a id="gga47ee94f9c08ff581f78590bfe024f6e4a5b1db073c57082b557592b7115a8e363" name="gga47ee94f9c08ff581f78590bfe024f6e4a5b1db073c57082b557592b7115a8e363"></a>JWT_VALIDATION_GRANT_MISMATCH&#160;</td><td class="fielddoc"><p>User-defined Grant mismatch <br  />
 </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="jwt_8h_source.html#l00236">236</a> of file <a class="el" href="jwt_8h_source.html">jwt.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga62aa101df260ec31133eeb4c4c52b80a" name="ga62aa101df260ec31133eeb4c4c52b80a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga62aa101df260ec31133eeb4c4c52b80a">&#9670;&#160;</a></span>jwt_exception_str()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX char * jwt_exception_str </td>
          <td>(</td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>exceptions</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses exceptions and returns a comma delimited and human-readable string. </p>
<p>The returned string must be freed by the caller. If you changed the allocation method using jwt_set_alloc, then you must use <a class="el" href="group__jwt__encode__grp.html#gaa4a31fd1663c0338afaf79d0ee3a4849" title="Free a string returned from the library.">jwt_free_str()</a> to free the memory.</p>
<dl class="section remark"><dt>Remarks</dt><dd>This string is currently en-US ASCII only. Language support will come in the future.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exceptions</td><td>Integer containing the exception flags. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A null terminated string on success, NULL on error with errno set appropriately. </dd></dl>

</div>
</div>
<a id="gaf314c644fea06547647958483759ceac" name="gaf314c644fea06547647958483759ceac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf314c644fea06547647958483759ceac">&#9670;&#160;</a></span>jwt_valid_add_grant()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX int jwt_valid_add_grant </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>grant</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>val</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new string grant requirement to this JWT validation object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">grant</td><td>String containing the name of the grant to add. </td></tr>
    <tr><td class="paramname">val</td><td>String containing the value to be saved for grant. Can be an empty string, but cannot be NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, valid errno otherwise.</dd></dl>
<p>Note, this only allows for string based grants. If you wish to add integer grants, then use <a class="el" href="#gabacde09b87fca8b096d291163f4c4a5c" title="Add a new integer grant requirement to this JWT validation object.">jwt_valid_add_grant_int()</a>. If you wish to add more complex grants (e.g. an array), then use <a class="el" href="#gab75b56ce400f582ace10a4e524635286" title="Add required grants from a JSON encoded object string.">jwt_valid_add_grants_json()</a>. </p>

</div>
</div>
<a id="ga8900a467e4176b1fa9b622a2705269ee" name="ga8900a467e4176b1fa9b622a2705269ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8900a467e4176b1fa9b622a2705269ee">&#9670;&#160;</a></span>jwt_valid_add_grant_bool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX int jwt_valid_add_grant_bool </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>grant</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>val</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new boolean required grant to this JWT validation object. </p>
<p>Creates a new grant for this object. The string for grant is copied internally, so do not require that the pointer or string remain valid for the lifetime of this object. It is an error if you try to add a grant that already exists.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">grant</td><td>String containing the name of the grant to add. </td></tr>
    <tr><td class="paramname">val</td><td>boolean containing the value to be saved for grant. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, valid errno otherwise.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This only allows for boolean based grants. If you wish to add string grants, then use <a class="el" href="#gaf314c644fea06547647958483759ceac" title="Add a new string grant requirement to this JWT validation object.">jwt_valid_add_grant()</a>. If you wish to add more complex grants (e.g. an array), then use <a class="el" href="#gab75b56ce400f582ace10a4e524635286" title="Add required grants from a JSON encoded object string.">jwt_valid_add_grants_json()</a>. </dd></dl>

</div>
</div>
<a id="gabacde09b87fca8b096d291163f4c4a5c" name="gabacde09b87fca8b096d291163f4c4a5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabacde09b87fca8b096d291163f4c4a5c">&#9670;&#160;</a></span>jwt_valid_add_grant_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX int jwt_valid_add_grant_int </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>grant</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>val</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new integer grant requirement to this JWT validation object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">grant</td><td>String containing the name of the grant to add. </td></tr>
    <tr><td class="paramname">val</td><td>int containing the value to be saved for grant. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, valid errno otherwise.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This only allows for integer based grants. If you wish to add string grants, then use <a class="el" href="#gaf314c644fea06547647958483759ceac" title="Add a new string grant requirement to this JWT validation object.">jwt_valid_add_grant()</a>. If you wish to add more complex grants (e.g. an array), then use <a class="el" href="#gab75b56ce400f582ace10a4e524635286" title="Add required grants from a JSON encoded object string.">jwt_valid_add_grants_json()</a>. </dd></dl>

</div>
</div>
<a id="gab75b56ce400f582ace10a4e524635286" name="gab75b56ce400f582ace10a4e524635286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab75b56ce400f582ace10a4e524635286">&#9670;&#160;</a></span>jwt_valid_add_grants_json()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX int jwt_valid_add_grants_json </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>json</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add required grants from a JSON encoded object string. </p>
<p>Loads a grant from an existing JSON encoded object string. Overwrites existing grant.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">json</td><td>String containing a JSON encoded object of grants. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, valid errno otherwise. </dd></dl>

</div>
</div>
<a id="gaf9f8b1dbe950cf2fc9a8200cf749a442" name="gaf9f8b1dbe950cf2fc9a8200cf749a442"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf9f8b1dbe950cf2fc9a8200cf749a442">&#9670;&#160;</a></span>jwt_valid_del_grants()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX int jwt_valid_del_grants </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>grant</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete a grant from this JWT object. </p>
<p>Deletes the named grant from this object. It is not an error if there is no grant matching the passed name. If grant is NULL, then all grants are deleted from this JWT.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">grant</td><td>String containing the name of the grant to delete. If this is NULL, then all grants are deleted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, valid errno otherwise. </dd></dl>

</div>
</div>
<a id="ga728df4b06a8265eaaea237641185c76f" name="ga728df4b06a8265eaaea237641185c76f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga728df4b06a8265eaaea237641185c76f">&#9670;&#160;</a></span>jwt_valid_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX void jwt_valid_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free a JWT validation object and any other resources it is using. </p>
<p>After calling, the JWT validation object referenced will no longer be valid and its memory will be freed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object previously created with <a class="el" href="#ga88d954bf262717532dba3f8d9d29c8af" title="Allocate a new, JWT validation object.">jwt_valid_new()</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaeb53cb3059ef0a6969f9d401e76958c2" name="gaeb53cb3059ef0a6969f9d401e76958c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeb53cb3059ef0a6969f9d401e76958c2">&#9670;&#160;</a></span>jwt_valid_get_exp_leeway()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX time_t jwt_valid_get_exp_leeway </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the exp_leeway value set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns current exp_leeway value </dd></dl>

</div>
</div>
<a id="ga7f2277d29179a01928c0ebe4fbef1a7c" name="ga7f2277d29179a01928c0ebe4fbef1a7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7f2277d29179a01928c0ebe4fbef1a7c">&#9670;&#160;</a></span>jwt_valid_get_grant()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX const char * jwt_valid_get_grant </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>grant</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the value of a string required grant. </p>
<p>Returns the string value for a grant (e.g. "iss"). If it does not exist, NULL will be returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">grant</td><td>String containing the name of the grant to return a value for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a string for the value, or NULL when not found.</dd></dl>
<p>Note, this will only return grants with JSON string values. Use <a class="el" href="#ga19a0badfa97417865fe6053c8d9c076e" title="Return the value of a grant as JSON encoded object string.">jwt_valid_get_grants_json()</a> to get the JSON representation of more complex values (e.g. arrays) or use <a class="el" href="#ga1af73c88e51e80f456e10cdd43bcf2f1" title="Return the value of an integer required grant.">jwt_valid_get_grant_int()</a> to get simple integer values. </p>

</div>
</div>
<a id="ga1bcf672c544bd4d2ebb656a79ce90f69" name="ga1bcf672c544bd4d2ebb656a79ce90f69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1bcf672c544bd4d2ebb656a79ce90f69">&#9670;&#160;</a></span>jwt_valid_get_grant_bool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX int jwt_valid_get_grant_bool </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>grant</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the value of an boolean required grant. </p>
<p>Returns the int value for a grant (e.g. "exp"). If it does not exist, 0 will be returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">grant</td><td>String containing the name of the grant to return a value for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a boolean for the value. Sets errno to ENOENT when not found.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This will only return grants with JSON boolean values. Use <a class="el" href="#ga19a0badfa97417865fe6053c8d9c076e" title="Return the value of a grant as JSON encoded object string.">jwt_valid_get_grants_json()</a> to get the JSON representation of more complex values (e.g. arrays) or use <a class="el" href="#ga7f2277d29179a01928c0ebe4fbef1a7c" title="Return the value of a string required grant.">jwt_valid_get_grant()</a> to get string values. </dd></dl>

</div>
</div>
<a id="ga1af73c88e51e80f456e10cdd43bcf2f1" name="ga1af73c88e51e80f456e10cdd43bcf2f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1af73c88e51e80f456e10cdd43bcf2f1">&#9670;&#160;</a></span>jwt_valid_get_grant_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX long jwt_valid_get_grant_int </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>grant</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the value of an integer required grant. </p>
<p>Returns the int value for a grant (e.g. "exp"). If it does not exist, 0 will be returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">grant</td><td>String containing the name of the grant to return a value for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns an int for the value. Sets errno to ENOENT when not found.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This will only return grants with JSON integer values. Use <a class="el" href="#ga19a0badfa97417865fe6053c8d9c076e" title="Return the value of a grant as JSON encoded object string.">jwt_valid_get_grants_json()</a> to get the JSON representation of more complex values (e.g. arrays) or use <a class="el" href="#ga7f2277d29179a01928c0ebe4fbef1a7c" title="Return the value of a string required grant.">jwt_valid_get_grant()</a> to get string values. </dd></dl>

</div>
</div>
<a id="ga19a0badfa97417865fe6053c8d9c076e" name="ga19a0badfa97417865fe6053c8d9c076e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga19a0badfa97417865fe6053c8d9c076e">&#9670;&#160;</a></span>jwt_valid_get_grants_json()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX char * jwt_valid_get_grants_json </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>grant</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the value of a grant as JSON encoded object string. </p>
<p>Returns the JSON encoded string value for a grant (e.g. "iss"). If it does not exist, NULL will be returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">grant</td><td>String containing the name of the grant to return a value for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a string for the value, or NULL when not found. The returned string must be freed by the caller. </dd></dl>

</div>
</div>
<a id="gaea88716bb3596c459da61677e8184662" name="gaea88716bb3596c459da61677e8184662"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaea88716bb3596c459da61677e8184662">&#9670;&#160;</a></span>jwt_valid_get_nbf_leeway()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX time_t jwt_valid_get_nbf_leeway </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the nbf_leeway value set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns current nbf_leeway value </dd></dl>

</div>
</div>
<a id="gaffc50a84a9914aa74f233054fd243a61" name="gaffc50a84a9914aa74f233054fd243a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaffc50a84a9914aa74f233054fd243a61">&#9670;&#160;</a></span>jwt_valid_get_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX <a class="el" href="#ga47ee94f9c08ff581f78590bfe024f6e4">jwt_valid_exception_t</a> jwt_valid_get_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the status string for the validation object. </p>
<p>The status of validation object is primarily for describing the reason <a class="el" href="#ga9ce197165c625f967f889212ca9fab86" title="Validate a JWT object with a validation object.">jwt_validate()</a> failed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns current validation status as a bitwise OR of possible errors, or 0 if validation is currently successful. </dd></dl>

</div>
</div>
<a id="ga88d954bf262717532dba3f8d9d29c8af" name="ga88d954bf262717532dba3f8d9d29c8af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga88d954bf262717532dba3f8d9d29c8af">&#9670;&#160;</a></span>jwt_valid_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX int jwt_valid_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> **</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__jwt__core__grp.html#ga889db178d8714ab67bc994f1d8faad33">jwt_alg_t</a></td>          <td class="paramname"><span class="paramname"><em>alg</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new, JWT validation object. </p>
<p>This is used to create a new object for a JWT validation. After you have finished with the object, use <a class="el" href="#ga728df4b06a8265eaaea237641185c76f" title="Free a JWT validation object and any other resources it is using.">jwt_valid_free()</a> to clean up the memory used by it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object pointer. Will be allocated on success. </td></tr>
    <tr><td class="paramname">alg</td><td>A valid jwt_alg_t specifier. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, valid errno otherwise. </dd></dl>

</div>
</div>
<a id="ga7d4a3188a889ae2a0837aec6f358cde5" name="ga7d4a3188a889ae2a0837aec6f358cde5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7d4a3188a889ae2a0837aec6f358cde5">&#9670;&#160;</a></span>jwt_valid_set_exp_leeway()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX int jwt_valid_set_exp_leeway </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const time_t</td>          <td class="paramname"><span class="paramname"><em>exp_leeway</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the exp_leeway value as defined in: <a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.4">https://www.rfc-editor.org/rfc/rfc7519#section-4.1.4</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">exp_leeway</td><td>leeway for exp value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, valid errno otherwise. </dd></dl>

</div>
</div>
<a id="gaf12cd57921f54714ec74ced386a80981" name="gaf12cd57921f54714ec74ced386a80981"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf12cd57921f54714ec74ced386a80981">&#9670;&#160;</a></span>jwt_valid_set_headers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX int jwt_valid_set_headers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>hdr</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set validation for replicated claims in headers. </p>
<p>When set, validation tests for presence of iss, sub, aud in jwt headers and tests match for same claims in body.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">hdr</td><td>When true, test header claims </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, valid errno otherwise.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd><a class="el" href="#ga9ce197165c625f967f889212ca9fab86" title="Validate a JWT object with a validation object.">jwt_validate()</a> will not fail if iss, sub, aud are not present in JWT header or body. </dd></dl>

</div>
</div>
<a id="gae0319eaec4c9a1e706b85aa365ada20e" name="gae0319eaec4c9a1e706b85aa365ada20e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae0319eaec4c9a1e706b85aa365ada20e">&#9670;&#160;</a></span>jwt_valid_set_nbf_leeway()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX int jwt_valid_set_nbf_leeway </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const time_t</td>          <td class="paramname"><span class="paramname"><em>nbf_leeway</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the nbf_leeway value as defined in: <a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.5">https://www.rfc-editor.org/rfc/rfc7519#section-4.1.5</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">nbf_leeway</td><td>leeway for nbf value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, valid errno otherwise. </dd></dl>

</div>
</div>
<a id="ga8e5fbc676ebc0a0286bc70b9d062d53e" name="ga8e5fbc676ebc0a0286bc70b9d062d53e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8e5fbc676ebc0a0286bc70b9d062d53e">&#9670;&#160;</a></span>jwt_valid_set_now()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX int jwt_valid_set_now </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const time_t</td>          <td class="paramname"><span class="paramname"><em>now</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the time for which expires and not-before claims should be evaluated. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object. </td></tr>
    <tr><td class="paramname">now</td><td>Time to use when considering nbf and exp claims. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, valid errno otherwise.</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd><a class="el" href="#ga9ce197165c625f967f889212ca9fab86" title="Validate a JWT object with a validation object.">jwt_validate()</a> will not fail based on time if no expires or not-before claims exist in a JWT object. </dd></dl>

</div>
</div>
<a id="ga9ce197165c625f967f889212ca9fab86" name="ga9ce197165c625f967f889212ca9fab86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9ce197165c625f967f889212ca9fab86">&#9670;&#160;</a></span>jwt_validate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JWT_EX <a class="el" href="#ga47ee94f9c08ff581f78590bfe024f6e4">jwt_valid_exception_t</a> jwt_validate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__jwt__core__grp.html#gabf0acfb990d245214216af589c1d0947">jwt_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#gac413377fbfc11671e8a8a66f45693e5d">jwt_valid_t</a> *</td>          <td class="paramname"><span class="paramname"><em>jwt_valid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate a JWT object with a validation object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jwt</td><td>Pointer to a JWT object. </td></tr>
    <tr><td class="paramname">jwt_valid</td><td>Pointer to a JWT validation object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bitwide OR if possible validation errors or 0 on success </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.12.0-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <a href="https://maclara-llc.com" target="_blank">
        <img src="https://img.shields.io/badge/Sponsored%20by-maClara%2C%20LLC-blue?style=plastic&logoColor=blue" alt="maClara, LLC">
      </a>
    </li>
  </ul>
</div>
</body>
</html>
